#!/bin/bash
#==============================================================================
#
#	THIS SCRIPT COMMITS TO GITHUB
#
#	$ ./p- ["commit msg"], ["/optional/html/target"], [<boolean>]  
#
#
#
#==============================================================================
#
#	SOME USEFUL VARIABLES
#
#==============================================================================
BASE="http://fdch.github.io"
REPO=$(basename `git rev-parse --show-toplevel`)
DATE=$(date +"%D %T")
COMMIT="...updates"
USAGE="$ ./p- [\"commit msg\"], [\"/optional/html/target\"], [<boolean>]"
#==============================================================================
function makeLine() {
	local i=0
	local sleepytime=0
	local color=2
	if [[ $1 ]] ; then
		sleepytime=$1
	fi 
	if [[ $2 ]] ; then
		color=$2
	fi 
	while [ $i -lt 80 ]
	do
		sleep "$sleepytime"
		echo -ne "$(tput setaf $color)="
		i=$[$i+1]
	done
	echo "$(tput sgr 0)"
}
#==============================================================================
#
#	CHECK FOR ARGUMENTS (NO ARGUMENT OPEN UP VIM EDITOR FOR COMMIT MESSAGE)
#
#==============================================================================
if [[ $1 ]] ; then
#==============================================================================
#
#	HELP MESSAGE
#
#==============================================================================
	if [ $1 = "-h" ] ; then
		echo ; echo "Usage:"; echo $USAGE ; echo ; exit ; fi
#==============================================================================
#
#	COMMIT MESSAGE
#
#==============================================================================
	COMMIT="$1"
fi
#==============================================================================
makeLine 0
#==============================================================================
if [[ $2 ]] ; then
#==============================================================================
#
#	ARGUMENT 2 = TARGET HTML PAGE
#
#==============================================================================
	URLTGT="/$2"
fi
if [[ $3 ]] ; then
#==============================================================================
#
#	START THE ABBY_QUOTE_ORDER SCRIPT
#
#==============================================================================
	echo "STARTING ABBY_QUOTE_ORDER SCRIPT..."
	cd abby_quote_order
	sh run.sh
	cd ..
fi
#==============================================================================
#
#	MAKE THE COMMIT
#
#==============================================================================
git add .
git commit -m "$COMMIT"
git push
#==============================================================================
#
#	SAY A FEW WORDS...
#
#==============================================================================
echo "$(tput setaf 2)
Committed $COMMIT to $REPO on $DATE $(tput sgr 0)
"
#==============================================================================
makeLine 0.3 0
#==============================================================================
#
#	OPEN THE TARGET HTML PAGE
#
#==============================================================================
open "$BASE/$REPO$URLTGT"
#==============================================================================
exit 0
#==============================================================================