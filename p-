#!/bin/bash
#
# This script commits to github, just run $ ./p- "optional commit msg"
#

BASE="http://fdch.github.io"
REPO=$(basename `git rev-parse --show-toplevel`)
DATE=$(date +"%D %T")
COMMIT="updates"

function makeLine() {
	local i=0
	local sleepytime=0
	local color=2
	if [[ $1 ]]
	then
		sleepytime=$1
	fi
	while [ $i -lt 80 ]
	do
		sleep "$sleepytime"
		echo -ne "$(tput setaf $RANDOM)="
		i=$[$i+1]
	done
	echo "$(tput sgr 0)"
}

makeLine 0

if [[ $1 ]] 
then
	COMMIT="$1"
fi
if [[ $2 ]]
then
	URLTGT="/$2"
fi
if [[ $3 ]]
then
	cd abby_quote_order
	sh run.sh
	cd ..
fi

git add .
git commit -m "$COMMIT"
git push
echo "$(tput setaf 2)
Committed $COMMIT to $REPO on $DATE $(tput sgr 0)
"

makeLine 0.3

open "$BASE/$REPO$URLTGT"

exit 0